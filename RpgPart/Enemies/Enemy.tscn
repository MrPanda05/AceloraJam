[gd_scene load_steps=10 format=3 uid="uid://iy5j55rlbgya"]

[ext_resource type="PackedScene" uid="uid://r4fhthgo4slo" path="res://Commons/Components/HealthComponent.tscn" id="1_c45wl"]
[ext_resource type="Texture2D" uid="uid://bw5u4t44g16id" path="res://icon.svg" id="1_ugmta"]
[ext_resource type="Script" path="res://RpgPart/Enemies/Enemy.cs" id="1_v0u8i"]
[ext_resource type="PackedScene" uid="uid://yqjfbe83sniv" path="res://Commons/Components/HitboxComponent.tscn" id="2_khf8v"]
[ext_resource type="PackedScene" uid="uid://p58i6ogpqa4a" path="res://Commons/FiniteStateMachine/Fsm.tscn" id="4_v12dv"]
[ext_resource type="Script" path="res://RpgPart/Enemies/States/Iddle.cs" id="6_ghyw5"]
[ext_resource type="Script" path="res://RpgPart/Enemies/States/Follow.cs" id="7_rc3jt"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ft7y3"]
size = Vector2(106, 89)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sf4xg"]
size = Vector2(109, 81)

[node name="Enemy" type="CharacterBody2D" node_paths=PackedStringArray("hitbox", "health", "fsm")]
collision_layer = 32
collision_mask = 2306
script = ExtResource("1_v0u8i")
speed = 300.0
hitbox = NodePath("HitboxComponent")
health = NodePath("HealthComponent")
fsm = NodePath("FSM")

[node name="Sprite2D" type="Sprite2D" parent="."]
position = Vector2(4, 7)
scale = Vector2(0.9375, 0.6875)
texture = ExtResource("1_ugmta")

[node name="HitboxComponent" parent="." node_paths=PackedStringArray("healthComponent") instance=ExtResource("2_khf8v")]
collision_layer = 545
collision_mask = 528
healthComponent = NodePath("../HealthComponent")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitboxComponent"]
position = Vector2(2, 8.5)
shape = SubResource("RectangleShape2D_ft7y3")

[node name="HealthComponent" parent="." instance=ExtResource("1_c45wl")]
health = 1.0
maxHealth = 9999.0

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(6.5, 5.5)
shape = SubResource("RectangleShape2D_sf4xg")

[node name="FSM" parent="." instance=ExtResource("4_v12dv")]
InitialState = NodePath("Follow")

[node name="Iddle" type="Node" parent="FSM"]
editor_description = "Iddle state, only for testing"
script = ExtResource("6_ghyw5")

[node name="Follow" type="Node" parent="FSM"]
editor_description = "Iddle state, only for testing"
script = ExtResource("7_rc3jt")

[node name="Timer" type="Timer" parent="."]
wait_time = 1.3

[connection signal="area_entered" from="HitboxComponent" to="." method="OnHitboxComponentAreaEntered"]
[connection signal="area_exited" from="HitboxComponent" to="." method="OnHitboxComponentAreaExited"]
[connection signal="timeout" from="Timer" to="." method="OnTimerTimeout"]
